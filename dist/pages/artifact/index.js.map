{"version":3,"sources":["pages/artifact/index.js"],"names":["app","getApp","col1H","col2H","Page","data","uuid","util","artCategories","id","title","styleSeries","selectId","scrollH","imgWidth","loadingCount","images","col1","col2","onLoad","wx","getSystemInfo","success","res","ww","windowWidth","wh","windowHeight","setData","loadImages","onReachBottom","onImageLoad","e","imageId","currentTarget","oImgW","detail","width","oImgH","height","scale","imgHeight","imageObj","i","length","img","push","imageDate","pic","concat","baseId","Date"],"mappings":"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","file":"index.js","sourcesContent":["const app = getApp()\nlet col1H = 0;\nlet col2H = 0;\n\n// 创建页面实例对象\nPage({\n  /**\n   * 页面的初始数据\n   */\n  data: {\n    uuid: app.util.uuid,\n    artCategories: [\n      {\n        id: '1',\n        title: '油画',\n        styleSeries:['现实分割', '差异风格', '工作风格', '现实分割', '差异风格', '工作风格']\n      },\n      {\n        id: '12',\n        title: '水彩',\n        styleSeries:['额发分割', '差异风格', '工作风格']\n      },\n      {\n        id: '123',\n        title: '山水',\n        styleSeries:['窃取实分割', '而且风格', '工作风格']\n      },\n      {\n        id: '1234',\n        title: '雕塑',\n        styleSeries:['啊实分割', '二维异风格', '恶趣味作风格']\n      },\n      {\n        id: '12345',\n        title: '雕塑',\n        styleSeries:['啊实分割', '二维异风格', '恶趣味作风格']\n      }\n      ,\n      {\n        id: '1255',\n        title: '雕塑',\n        styleSeries:['啊实分割', '二维异风格', '恶趣味作风格']\n      },\n      {\n        id: '13',\n        title: '雕塑',\n        styleSeries:['啊实分割', '二维异风格', '恶趣味作风格']\n      },\n      {\n        id: '14',\n        title: '雕塑',\n        styleSeries:['啊实分割', '二维异风格', '恶趣味作风格']\n      }\n    ],\n    selectId: '1234',\n    scrollH: 0,\n    imgWidth: 0,\n    loadingCount: 0,\n    images: [],\n    col1: [],\n    col2: []\n\n  },\n\n  onLoad: function () {\n\n    //加载瀑布流\n    wx.getSystemInfo({\n      success: (res) => {\n        let ww = res.windowWidth;\n        let wh = res.windowHeight;\n        let imgWidth = ww * 0.48;\n        let scrollH = wh;\n\n        this.setData({\n          scrollH: scrollH,\n          imgWidth: imgWidth\n        });\n\n        //加载首组图片\n        this.loadImages();\n      }\n    })\n  },\n\n  onReachBottom: function () {\n   this.loadImages()\n  },\n\n  //瀑布流\n  onImageLoad: function (e) {\n    let imageId = e.currentTarget.id;\n    let oImgW = e.detail.width;         //图片原始宽度\n    let oImgH = e.detail.height;        //图片原始高度\n    let imgWidth = this.data.imgWidth;  //图片设置的宽度\n    let scale = imgWidth / oImgW;        //比例计算\n    let imgHeight = oImgH * scale;      //自适应高度\n\n    let images = this.data.images;\n    let imageObj = null;\n\n    for (let i = 0; i < images.length; i++) {\n      let img = images[i];\n      if (img.id === imageId) {\n        imageObj = img;\n        break;\n      }\n    }\n\n    imageObj.height = imgHeight;\n\n    let loadingCount = this.data.loadingCount - 1;\n    let col1 = this.data.col1;\n    let col2 = this.data.col2;\n\n    //判断当前图片添加到左列还是右列\n    if (col1H <= col2H) {\n      col1H += imgHeight;\n      col1.push(imageObj);\n    } else {\n      col2H += imgHeight;\n      col2.push(imageObj);\n    }\n\n    let data = {\n      loadingCount: loadingCount,\n      col1: col1,\n      col2: col2\n    };\n\n    //当前这组图片已加载完毕，则清空图片临时加载区域的内容\n    if (!loadingCount) {\n      data.images = [];\n    }\n\n    this.setData(data);\n  },\n\n  imageDate:  [\n    { pic: \"http://image.artful.com.cn/artful/other/2017-12-16/3e8814abf1d2d370!960xAuto\", height: 0 },\n    { pic: \"http://image.artful.com.cn/artful/other/2017-12-08/6dbd9088de7404a0.jpg!960xAuto\", height: 0 },\n    { pic: \"http://image.artful.com.cn/artful/other/2017-12-16/6439ac986b55971d!960xAuto\", height: 0 },\n    { pic: \"http://image.artful.com.cn/artful/other/2017-12-08/6dbd9088de7404a0.jpg!960xAuto\", height: 0 },\n\n  ],\n\n  loadImages: function () {\n    this.imageDate = this.imageDate.concat( [\n      { pic: \"http://image.artful.com.cn/artful/other/2017-12-08/6dbd9088de7404a0.jpg!960xAuto\", height: 0 },\n      { pic: \"http://image.artful.com.cn/artful/other/2017-12-16/6439ac986b55971d!960xAuto\", height: 0 },\n      { pic: \"http://image.artful.com.cn/artful/other/2017-12-08/6dbd9088de7404a0.jpg!960xAuto\", height: 0 },\n      { pic: \"http://image.artful.com.cn/artful/other/2017-12-16/cf76da9725aade55!960xAuto\", height: 0 },\n      { pic: \"http://image.artful.com.cn/artful/other/2017-12-16/3e8814abf1d2d370!960xAuto\", height: 0 },\n\n    ])\n    let images = this.imageDate\n\n    let baseId = \"img-\" + (+new Date());\n\n    for (let i = 0; i < images.length; i++) {\n      images[i].id = baseId + \"-\" + i;\n    }\n\n    this.setData({\n      loadingCount: images.length,\n      images: images\n    });\n  }\n})"]}